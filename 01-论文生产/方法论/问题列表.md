  问题 1：TSet 载荷篡改的归约目标错误——流密码不提供完整性
  第三章 $G_1$（消除 TSet 载荷篡改，第 160-165 行）将归约目标定为 PRF 安全性，理由是"对手篡改密文等价于对手预测 PRF 输出的特定比特位"。这个论证是错误的。

  TSet 载荷加密结构为 $\mathsf{val}' = (\mathsf{id}|\mathsf{op}|\mathsf{Cm}) \oplus G(w, \mathsf{cnt}, K_T)$，这是流密码（XOR pad）。流密码的关键弱点是：对手无需知道 PRF
  输出即可定向篡改明文。具体攻击如下：

  1. Update 阶段，GK 向 Server 发送 $(\mathsf{addr}, \mathsf{val}', \alpha, {\mathsf{xtag}i}{i \in [\ell]})$
  2. Server 收到明文 xtag，可自行计算 $\mathsf{Cm} = H_c(\mathsf{xtag}1|\cdots|\mathsf{xtag}\ell)$
  3. Server 选择伪造标签 ${\mathsf{xtag}'_i}$，计算 $\mathsf{Cm}' = H_c(\mathsf{xtag}'1|\cdots|\mathsf{xtag}'\ell)$
  4. Server 计算 $\delta = \mathsf{Cm} \oplus \mathsf{Cm}'$，在 $\mathsf{val}'$ 的 Cm 字段位置 XOR $\delta$
  5. Client 解密得到 $(\mathsf{id}, \mathsf{op}, \mathsf{Cm}')$，验证 $H_c(\mathsf{xtag}'1|\cdots|\mathsf{xtag}'\ell) = \mathsf{Cm}'$ 通过

  这是一个真实的攻击。Server 知道 Cm 的明文值（因为 xtag 在 Update 阶段以明文发送），因此可以精确地修改密文中的 Cm 字段而不影响 id 和 op 字段。

  修正方案：TSet 载荷加密必须从流密码升级为认证加密（AE），使用系统模型中已定义的 $\mathsf{AE} = (\mathsf{AE.Enc}, \mathsf{AE.Dec})$，满足 IND-CPA + INT-CTXT。$G_1$
  的归约目标应改为 INT-CTXT（密文完整性）：若 $\mathcal{A}$ 能篡改 TSet 密文且解密不返回 $\bot$，则构成 INT-CTXT 伪造。

  这一修正同时影响：
  - commitment.tex 中算法 5 的载荷加密公式（公式 4）
  - bf.tex 中原 Nomos Update 算法的载荷加密描述
  - 组合安全性 $G_2$ 的归约目标（从 PRF 改为 INT-CTXT）
  - 最终优势界中的假设列表（增加 INT-CTXT，移除 PRF）

  ---
  问题 2：第二章 VQ-Sound 游戏的 $p_2 = 0$ 论证隐含了未声明的前提

  第 121-122 行论证 $G_2$ 中 $\mathcal{A}$ 的胜利概率为零："Client 据此重算判定位 $v'{j,\mathsf{id}} = \bigwedge{a \in \mathcal{A}{j,\mathsf{id}}^{(t,\nu)}} B^{(t)}[a] =
  v{j,\mathsf{id}}^{(t,\nu)}$"。

  这个等式成立的前提是：证明中使用的地址确实是令牌绑定的地址集合 $\mathcal{A}{j,\mathsf{id}}^{(t,\nu)}$。但在第二章的 VQ-Verify 中，Client 不执行地址归属验证（那是第三章的
  Verify' 才有的步骤）。如果 Server 实施地址替换攻击，证明地址不属于 $\mathcal{A}{j,\mathsf{id}}^{(t,\nu)}$，则 $G_2$ 中 $\mathcal{A}$ 仍可胜利。

  修正方案：VQ-Sound 的安全声明必须显式标注为条件性质——"在地址归属正确的前提下"成立。这与 bf.tex 中命题 2 的现有表述一致（"在地址归属正确前提下"）。具体做法：

  - 在 $\mathsf{Exp}^{\mathsf{VQ\text{-}Sound}}$ 的胜利条件中增加前提："$\mathcal{A}$ 提供的证明地址均属于 $\mathcal{A}_{j,\mathsf{id}}^{(t,\nu)}$"
  - 或者将 VQ-Sound 定义为条件实验，在实验描述中明确"本实验假设地址归属正确，地址正确性由 $\mathsf{Exp}^{\mathsf{AB\text{-}Sound}}$ 独立保证"
  - $p_2 = 0$ 的论证中显式引用该前提

  这样三个安全实验的逻辑关系变为：
  - $\mathsf{Exp}^{\mathsf{VQ\text{-}Sound}}$：条件性质（假设地址正确 → 位值不可伪造）
  - $\mathsf{Exp}^{\mathsf{AB\text{-}Sound}}$：独立性质（地址不可替换）
  - $\mathsf{Exp}^{\mathsf{CV}}$：组合性质（无条件，四步游戏跳跃闭合）

  ---
  中等问题（影响严谨性，应修正）

  问题 3：AB-Sound 游戏的胜利条件不够精确

  第 146-149 行的胜利条件为"Open_{j,id} 中存在某地址 $a \notin \mathcal{F}_{w_j,\mathsf{id}}$"。但实际攻击还包括另一种情形：开封材料中的 $\ell$ 个地址全部正确，但 Server 在 QTree
   证明中使用的 $k$ 个地址不是 $\ell$ 个地址中由 ${\beta_i}$ 索引的子集。

  修正方案：胜利条件应扩展为：
  acc = 1 ∧ ∃(j, id) ∈ R(Q*):
    (Open_{j,id} 中存在某地址 a ∉ F_{w_j,id})
    ∨ (Proof_{j,id} 中使用的某地址 a' ∉ {xtag_{j,id,β_1},...,xtag_{j,id,β_k}})

  不过第二种情形实际上被 Client 的子集归属检查在验证阶段直接拒绝（不需要密码学归约），所以可以在 $G_2$ 的 $p_2 = 0$
  论证中说明：即使开封正确，子集归属检查也确保了证明地址的正确性。但胜利条件的形式化应覆盖这一情形。

  ---
  问题 4：组合安全性 $\mathsf{Exp}^{\mathsf{CV}}$ 的实验描述过于简略

  第 187-191 行的 CV 实验仅写"1-4. 同 Exp^{VQ-Sound}"，但 CV 实验的 Challenger 行为与 VQ-Sound 有实质差异：
  - Challenger 在 Update 时需要计算并嵌入 Cm（第三章扩展）
  - Challenger 维护的状态包括 $T_{\mathsf{cm}}$ 和 $T_{\mathsf{xtag}}$ 表
  - Verify 使用四层验证流程 Verify'

  修正方案：CV 实验应完整写出 Challenger 的行为，至少列出与 VQ-Sound 的差异点，而非简单引用。

  ---
  问题 5：最终优势界中的安全假设需要统一修正

  修正问题 1 后，三个优势界均需更新：

  - VQ-Sound：$\mathsf{Adv}^{\mathsf{EUF\text{-}CMA}} + \mathsf{Adv}^{\mathsf{CR}}_H$（不变）
  - AB-Sound：$\mathsf{Adv}^{\mathsf{INT\text{-}CTXT}}{\mathsf{AE}} + \mathsf{Adv}^{\mathsf{CR}}{H_c}$（PRF → INT-CTXT）
  - CV：$\mathsf{Adv}^{\mathsf{EUF\text{-}CMA}} + \mathsf{Adv}^{\mathsf{INT\text{-}CTXT}}{\mathsf{AE}} + \mathsf{Adv}^{\mathsf{CR}}{H_c} + \mathsf{Adv}^{\mathsf{CR}}_H$（PRF →
  INT-CTXT）

  ---
  轻微问题（建议改进）

  问题 6：VSSE 对比表格式断裂

  第 345-348 行，"本文"列的通信开销和计算开销被换行截断，导致表格不完整。粘贴时需确保每行在同一行内。
  ---                                                                                                                                                                             
  问题 7：对比表缺少"泄露函数"维度                          
                                                                                                                                                                                  
  对比总表（第 335-349 行）在分类描述中列出了"泄露函数"维度（每个方案都有描述），但总表中没有对应行。泄露函数是 SSE 方案的核心区分维度之一，建议在表中增加一行。特别是本文方案引入
   QTree 后的额外泄露（Merkle 路径泄露访问模式的部分信息）应在表中体现，这也是审稿人可能追问的点。

  ---
  问题 8：新鲜性实验的形式化不够充分

  第 129-132 行将新鲜性作为绑定健全性 $G_1$ 的"直接推论"处理，不给出独立的游戏序列。这在技术上可行，但形式上不够严谨。建议至少给出 $\mathsf{Exp}^{\mathsf{Fresh}}$
  的实验定义（Challenger 行为、胜利条件），然后在证明中说明"该实验的胜利事件是 $\mathsf{Exp}^{\mathsf{VQ\text{-}Sound}}$ 中事件 $E_1$ 的子集，因此优势界被
  $\mathsf{Adv}^{\mathsf{EUF\text{-}CMA}}$ 所界"。这样既保持了简洁性，又满足了形式化要求。

  ---
  问题 9：归约算法 $\mathcal{B}_i$ 缺少模拟能力论证

  三个游戏跳跃序列中，每步过渡都声称"$\mathcal{B}i$ 模拟 $G{i-1}$ 的全部交互"，但未论证 $\mathcal{B}_i$ 是否有能力完成模拟。例如：

  - VQ-Sound 的 $\mathcal{B}_1$（归约到 EUF-CMA）：$\mathcal{B}_1$ 收到验证公钥 $\mathsf{pk}G$，需要用签名预言机回答 $O{\mathsf{Anchor}}$ 查询。$\mathcal{B}1$ 能否模拟
  $O{\mathsf{Update}}$？需要说明 $\mathcal{B}_1$ 持有除签名密钥外的所有密钥（$K_S, K_X, K_T$ 等），因此能正常执行 Update 和 GenToken。
  - AB-Sound 的 $\mathcal{B}_1$（归约到 INT-CTXT，修正后）：$\mathcal{B}_1$ 需要用 AE 加密预言机加密 TSet 载荷。$\mathcal{B}1$ 能否模拟 $O{\mathsf{Update}}$？需要说明
  $\mathcal{B}_1$ 持有除 AE 密钥外的所有密钥。

  写入 LaTeX 时，每个归约算法应有一段"模拟论证"，说明 $\mathcal{B}_i$ 持有哪些密钥、使用哪些预言机、模拟的分布与真实实验不可区分。

  ---
  问题 10：VSSE 对比中遗漏了 OXT 原始论文的定位

  不可替代性论证（第 351-399 行）论证了已有 VSSE 方案不适用于 Nomos，但未讨论 OXT 原始论文（Cash et al., CRYPTO 2013）本身是否提供了任何可验证性机制。审稿人可能会问："OXT
  自身有没有考虑过可验证性？"答案是没有——OXT 的安全定义是基于模拟的隐私保护，不涉及正确性验证。建议在 4.5 节"本文方案的独特定位"中增加一句，明确 OXT/Nomos
  的原始设计不包含任何可验证性机制，本文是首个为 OXT 架构引入可验证性的工作。

  ---
  问题 11：参考文献补充列表不完整

  第 401-409 行列出了 5 篇需补充的文献，但遗漏了几篇关键引用：

  - Cash, Jarecki, Jutla, Krawczyk, Rosu & Steiner, "Highly-Scalable Searchable Symmetric Encryption with Support for Boolean Queries", CRYPTO 2013（OXT
  原始论文，是整个架构的基础）
  - Bost, "Σoφoς: Forward Secure Searchable Encryption", CCS 2016（前向安全 SSE 的标准参考，与 Zhang 2019 对比时需要）
  - Merkle, "A Digital Signature Based on a Conventional Encryption Function", CRYPTO 1987（MHT 原始论文，如果 thesis.bib 中尚未包含）

  ---
  结构性建议

  建议 1：安全证明与 VSSE 对比应分开管理

  当前文件将两个独立内容（安全证明强化方案 + VSSE 对比）放在同一节中，用"内容二"标记分隔（第 237 行）。建议拆分为两个独立的顶级节，各自有清晰的标题和执行计划，避免在写入 LaTeX
  时混淆。

  建议 2：执行计划应标注优先级和依赖关系

  两个执行计划（第 217-234 行和第 411-420 行）均为平铺列表。建议标注：
  - 问题 1 的修正（TSet 加密升级为 AE）是最高优先级，因为它影响算法伪代码、安全定义和证明的所有层面
  - commitment.tex 的算法 5 修改必须先于安全证明写入
  - bf.tex 的安全证明改造可与 commitment.tex 并行进行（两者的游戏跳跃序列独立）

  ---
  总结

  7 个严重/中等问题中，问题 1（流密码不提供完整性）是最关键的——它不仅影响证明的正确性，还需要修改协议本身（TSet 载荷加密方式）。问题 2（VQ-Sound
  的条件性质）是形式化层面的缺陷，不影响最终的组合安全性，但必须在论文中显式声明。